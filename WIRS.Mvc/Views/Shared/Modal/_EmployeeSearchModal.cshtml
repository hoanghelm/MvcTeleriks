@model WIRS.Mvc.ViewModels.EmployeeSearchViewModel

@{
    var modalId = Model?.ModalId ?? "employeeSearchModal";
    var gridId = Model?.GridId ?? "employeeSearchGrid";
    var onSelectCallback = Model?.OnSelectCallback ?? "onEmployeeSelected";
}

<div id="@modalId" style="display:none;">
    <div class="simple-search-container">
        <div class="search-form">
            <div class="search-fields">
                <div class="field-group" style="flex: 1;">
                    <input kendo-text-box
                           id="filterEmployeeName"
                           placeholder="Search by employee name..."
                           class="search-input k-textbox"
                           style="width: 100%;"
                           onkeydown="if(event.keyCode===13) performAdvancedSearch();" />
                </div>
                <div class="search-button">
                    <button type="button"
                            id="btnSearch"
                            class="btn-primary k-button"
                            onclick="performAdvancedSearch()">
                        <svg class='w-4 h-4' fill='none' stroke='currentColor' viewBox='0 0 24 24'>
                            <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z'></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <div class="results-section">
            <div id="@gridId"></div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {

        $("#@modalId").kendoWindow({
            title: "Search Employee",
            modal: true,
            width: 1000,
            height: 600,
            visible: false,
            resizable: false,
            actions: ["Close"],
            open: function() {
                onEmployeeSearchModalOpen();
            },
            close: function() {
                onEmployeeSearchModalClose.call(this);
            }
        });

        $("#@gridId").kendoGrid({
            columns: [
                {
                    field: "EmployeeId",
                    title: "Employee No",
                    width: 120,
                    template: "<a href='\\#' onclick='selectEmployeeById(\"#=EmployeeId#\"); return false;' style='color: \\#0066cc; text-decoration: underline;'>#=EmployeeId#</a>"
                },
                { field: "EmployeeName", title: "Employee Name", width: 200 },
                { field: "CostCentreName", title: "Cost Center", width: 200 },
                { field: "Designation", title: "Designation", width: 180 },
                { field: "ContactNo", title: "Contact No", width: 120 }
            ],
            sortable: true,
            pageable: {
                pageSizes: [10, 25, 50]
            },
            height: 350,
            dataSource: {
                data: [],
                pageSize: 10,
                schema: {
                    model: {
                        id: "EmployeeId",
                        fields: {
                            EmployeeId: { type: "string" },
                            EmployeeName: { type: "string" },
                            CostCentreName: { type: "string" },
                            Designation: { type: "string" },
                            Email: { type: "string" },
                            ContactNo: { type: "string" }
                        }
                    }
                }
            },
            noRecords: {
                template: "<div class='simple-empty-state'><p>No employees found.</p></div>"
            }
        });
    });
</script>